var ROS2D=ROS2D||{REVISION:"1"};ROS2D.MapClient=function(b){var c=this;var b=b||{};this.ros=b.ros;this.topic=b.mapTopic||"/map";this.continuous=b.continuous;this.pose=null;this.resolution=null;this.image=document.createElement("canvas");var a=new ROSLIB.Topic({ros:this.ros,name:this.topic,messageType:"nav_msgs/OccupancyGrid",compression:"png"});a.subscribe(function(m){var f=c.image.getContext("2d");c.pose=new ROSLIB.Pose({position:m.info.origin.position,orientation:m.info.origin.orientation});c.resolution=m.info.resolution;var e=m.info.width;var n=m.info.height;c.image.width=e;c.image.height=n;var d=f.createImageData(e,n);for(var o=0;o<n;o++){for(var h=0;h<e;h++){var l=h+((n-o-1)*e);var k=m.data[l];if(k===100){var g=0}else{if(k===0){var g=255}else{var g=127}}var j=(h+(o*e))*4;d.data[j]=g;d.data[++j]=g;d.data[++j]=g;d.data[++j]=255}}f.putImageData(d,0,0);if(!c.continuous){a.unsubscribe()}c.emit("ready",c.image)})};ROS2D.MapClient.prototype.__proto__=EventEmitter2.prototype;ROS2D.Viewer=function(b){var c=this;var b=b||{};this.divID=b.divID;this.width=b.width;this.height=b.height;this.background=b.background||"#111111";var a=document.createElement("canvas");a.style.width=this.width+"px";a.style.height=this.height+"px";a.style.background=this.background;this.scene=new createjs.Stage(a);document.getElementById(this.divID).appendChild(a)};ROS2D.Viewer.prototype.addObject=function(a){this.scene.addChild(a);this.scene.update()};ROS2D.MapLoader=function(a){a=a||{};this.ros=a.ros;this.viewer=a.viewer};ROS2D.MapLoader.prototype.loadTopic=function(b,d){var c=this;var a=new ROS2D.MapClient({ros:this.ros,topic:b,continuous:d});a.on("ready",function(f){var e=new createjs.Bitmap(f);e.addEventListener("mousedown",function(){console.log("test")});c.viewer.addObject(e)})};