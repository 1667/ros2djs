var ROS2D=ROS2D||{REVISION:"1"};createjs.Stage.prototype.globalToRos=function(t,e){var i=t/this.scaleX,o=(this.y-e)/this.scaleY;return{x:i,y:o}},createjs.Stage.prototype.rosQuaternionToGlobalTheta=function(t){var e=t.w,i=t.x,o=t.y,s=t.z,r=Math.atan2(2*(e*s+i*o),1-2*(Math.pow(o,2)+Math.pow(s,2))),n=r*(180/Math.PI);return n>=0&&180>=n?n+=270:n-=90,-n},ROS2D.OccupancyGrid=function(t){t=t||{};var e=t.message,i=document.createElement("canvas"),o=i.getContext("2d");this.pose=new ROSLIB.Pose({position:e.info.origin.position,orientation:e.info.origin.orientation}),this.width=e.info.width,this.height=e.info.height,i.width=this.width,i.height=this.height;for(var s=o.createImageData(this.width,this.height),r=0;this.height>r;r++)for(var n=0;this.width>n;n++){var a,h=n+(this.height-r-1)*this.width,c=e.data[h];a=100===c?0:0===c?255:127;var d=4*(n+r*this.width);s.data[d]=a,s.data[++d]=a,s.data[++d]=a,s.data[++d]=255}o.putImageData(s,0,0),createjs.Bitmap.call(this,i),this.y=-this.height*e.info.resolution,this.scaleX=e.info.resolution,this.scaleY=e.info.resolution,this.width*=this.scaleX,this.height*=this.scaleY},ROS2D.OccupancyGrid.prototype.__proto__=createjs.Bitmap.prototype,ROS2D.OccupancyGridClient=function(t){var e=this;t=t||{};var i=t.ros,o=t.topic||"/map";this.continuous=t.continuous,this.rootObject=t.rootObject||new createjs.Container,this.currentGrid=null;var s=new ROSLIB.Topic({ros:i,name:o,messageType:"nav_msgs/OccupancyGrid",compression:"png"});s.subscribe(function(t){e.currentGrid&&e.rootObject.removeChild(e.currentGrid),e.currentGrid=new ROS2D.OccupancyGrid({message:t}),e.rootObject.addChild(e.currentGrid),e.emit("change"),e.continuous||s.unsubscribe()})},ROS2D.OccupancyGridClient.prototype.__proto__=EventEmitter2.prototype,ROS2D.NavigationArrow=function(t){t=t||{};var e=t.size||10,i=t.strokeSize||3,o=t.strokeColor||createjs.Graphics.getRGB(0,0,0),s=t.fillColor||createjs.Graphics.getRGB(255,0,0),r=new createjs.Graphics;r.setStrokeStyle(i),r.moveTo(-e/2,e/2),r.beginStroke(o),r.beginFill(s),r.lineTo(0,-e),r.lineTo(e/2,e/2),r.lineTo(-e/2,e/2),r.closePath(),r.endFill(),r.endStroke(),createjs.Shape.call(this,r)},ROS2D.NavigationArrow.prototype.__proto__=createjs.Shape.prototype,ROS2D.Viewer=function(t){var e=this;t=t||{},this.divID=t.divID,this.width=t.width,this.height=t.height,this.resolution=t.resolution||.05,this.background=t.background||"#111111";var i=document.createElement("canvas");i.width=this.width,i.height=this.height,i.style.background=this.background,document.getElementById(this.divID).appendChild(i),this.scene=new createjs.Stage(i),this.scene.y=this.height,document.getElementById(this.divID).appendChild(i),createjs.Ticker.setFPS(30),createjs.Ticker.addListener(function(){e.scene.update()})},ROS2D.Viewer.prototype.addObject=function(t){this.scene.addChild(t)},ROS2D.Viewer.prototype.scaleToDimensions=function(t,e){this.scene.scaleX=this.width/t,this.scene.scaleY=this.height/e};